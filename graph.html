<!-- public/graph.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Graph Iframe</title>
  <!-- Vue 3 via CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <!-- uPlot -->
  <link  href="https://unpkg.com/uplot@1.6.17/dist/uPlot.min.css" rel="stylesheet"/>
  <script src="https://unpkg.com/uplot@1.6.17/dist/uPlot.iife.min.js"></script>
  <style>html,body{margin:0;height:100%}#chart{width:100%;height:100%}</style>
</head>
<body>
  <div id="app"><canvas id="chart"></canvas></div>
  <script>
    const { createApp, onMounted, ref } = Vue;
    createApp({
      setup() {
        const chart = ref(null);
        onMounted(() => {
          const opts = {
            title: "10-series @10 Hz",
            width: innerWidth, height: innerHeight,
            scales: { x:{time:false} },
            series: [{label:"t(s)"}, ...[...Array(10)].map((_,i)=>({label:`p${i+1}`}))],
            axes: [{},...Array(10).fill({})],
          };
          const data = [[], ...[...Array(10)].map(()=>[])];
          chart.value = new uPlot(opts, data, document.getElementById("chart"));
          setInterval(()=>{
            const t = +(Date.now()/1000).toFixed(2);
            data[0].push(t);
            for(let i=1;i<=10;i++) data[i].push(Math.random()*100);
            if (data[0].length>200) data.forEach(a=>a.shift());
            chart.value.setData(data);
          }, 100);
        });
      }
    }).mount("#app");
  </script>
</body>
</html>
